---
title: cloud-monitoring-query-prometheus
type: docs
weight: 1
description: The "cloud-monitoring-query-prometheus" tool fetches time series metrics for a project using a given prometheus query.
---

The `cloud-monitoring-query-prometheus` tool fetches timeseries metrics data from Google Cloud Monitoring for a project using a given prometheus query.

## About

The `cloud-monitoring-query-prometheus` tool allows you to query all metrics available in Google Cloud Monitoring using the Prometheus Query Language (PromQL).
It's compatible with any of the following sources:

- [cloud-monitoring](../../sources/cloud-monitoring.md)

## Prerequisites

To use this tool, you need to have the following IAM role on your Google Cloud project:

- `roles/monitoring.viewer`

## Arguments

| Name        | Type   | Description                               |
| ----------- | ------ | ----------------------------------------- |
| `projectId` | string | The Google Cloud project ID.              |
| `query`     | string | The Prometheus query to execute.          |

## Use Cases

- **Ad-hoc analysis:** Quickly investigate performance issues by executing direct promql queries for a database instance.
- **Prebuilt Configs:** Use the already added prebuilt tools mentioned in prebuilt-tools.md to query the databases system/query level metrics. 

Here are some common use cases for the `cloud-monitoring-query-prometheus` tool:

- **Monitoring resource utilization:** Track CPU, memory, and disk usage for your database instance (Can use the [prebuilt tools](../../../reference/prebuilt-tools.md)).
- **Monitoring query performance:** Monitor latency, execution_time, wait_time for database instance or even for the queries running (Can use the [prebuilt tools](../../../reference/prebuilt-tools.md)).
- **System Health:** Get the overall system health for the database instance (Can use the [prebuilt tools](../../../reference/prebuilt-tools.md)).

## Examples

Here are some examples of how to use the `cloud-monitoring-query-prometheus` tool.


```yaml
tools:
 get_wait_time_metrics:
    kind: cloud-monitoring-query-prometheus
    source: cloud-monitoring-source
    description: |
      This tool fetches system wait time information for AlloyDB cluster, instance. Get the `projectID`, `clusterID` and `instanceID` from the user intent. To use this tool, you must provide the Google Cloud `projectId` and a PromQL `query`.
      Generate `query` using these metric details:
      metric: `alloydb.googleapis.com/instance/postgresql/wait_time`,  monitored_resource: `alloydb.googleapis.com/Instance`. labels: `cluster_id`, `instance_id`, `wait_event_type`, `wait_event_name`.
      Basic time series example promql query: `avg_over_time({"__name__"="alloydb.googleapis.com/instance/postgresql/wait_time","monitored_resource"="alloydb.googleapis.com/Instance","instance_id"="alloydb-instance"}[5m])`
```

## Available Metrics

Here are the reference available metrics list for the `cloud-monitoring-query-prometheus` tool, categorized by database type:

### AlloyDB for PostgreSQL

**System Metrics**

| Metric Name                                                                          | Description                                                                                                                            | Monitored Resource             | Labels                                                              |
| ------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------ | ------------------------------------------------------------------- |
| `alloydb.googleapis.com/instance/cpu/average_utilization`                            | The percentage of CPU being used on an instance.                                                                                       | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/cpu/maximum_utilization`                            | Maximum CPU utilization across all currently serving nodes of the instance from 0 to 100.                                              | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/cluster/storage/usage`                                       | The total AlloyDB storage in bytes across the entire cluster.                                                                          | `alloydb.googleapis.com/Cluster`  | `cluster_id`                                                        |
| `alloydb.googleapis.com/instance/postgres/replication/replicas`                      | The number of read replicas connected to the primary instance.                                                                         | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`, `state`, `replica_instance_id`         |
| `alloydb.googleapis.com/instance/postgres/replication/maximum_lag`                   | The maximum replication time lag calculated across all serving read replicas of the instance.                                          | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`, `replica_instance_id`                  |
| `alloydb.googleapis.com/instance/memory/min_available_memory`                        | The minimum available memory across all currently serving nodes of the instance.                                                       | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgres/instances`                                 | The number of nodes in the instance, along with their status, which can be either up or down.                                          | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`, `status`                               |
| `alloydb.googleapis.com/database/postgresql/tuples`                                  | Number of tuples (rows) by state per database in the instance.                                                                         | `alloydb.googleapis.com/Database` | `cluster_id`, `instance_id`, `database`, `state`                    |
| `alloydb.googleapis.com/database/postgresql/temp_bytes_written_for_top_databases`    | The total amount of data(in bytes) written to temporary files by the queries per database for top 500 dbs.                               | `alloydb.googleapis.com/Database` | `cluster_id`, `instance_id`, `database`                             |
| `alloydb.googleapis.com/database/postgresql/temp_files_written_for_top_databases`    | The number of temporary files used for writing data per database while performing internal algorithms like join, sort etc for top 500 dbs. | `alloydb.googleapis.com/Database` | `cluster_id`, `instance_id`, `database`                             |
| `alloydb.googleapis.com/database/postgresql/inserted_tuples_count_for_top_databases` | The total number of rows inserted per db for top 500 dbs as a result of the queries in the instance.                                     | `alloydb.googleapis.com/Database` | `cluster_id`, `instance_id`, `database`                             |
| `alloydb.googleapis.com/database/postgresql/updated_tuples_count_for_top_databases`  | The total number of rows updated per db for top 500 dbs as a result of the queries in the instance.                                      | `alloydb.googleapis.com/Database` | `cluster_id`, `instance_id`, `database`                             |
| `alloydb.googleapis.com/database/postgresql/deleted_tuples_count_for_top_databases`  | The total number of rows deleted per db for top 500 dbs as a result of the queries in the instance.                                      | `alloydb.googleapis.com/Database` | `cluster_id`, `instance_id`, `database`                             |
| `alloydb.googleapis.com/database/postgresql/backends_for_top_databases`              | The current number of connections per database to the instance for top 500 dbs.                                                        | `alloydb.googleapis.com/Database` | `cluster_id`, `instance_id`, `database`                             |
| `alloydb.googleapis.com/instance/postgresql/backends_by_state`                       | The current number of connections to the instance grouped by the state.                                                                | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`, `state`                                |
| `alloydb.googleapis.com/instance/postgresql/backends_for_top_applications`           | The current number of connections to the AlloyDB instance, grouped by applications for top 500 applications.                           | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`, `application_name`                     |
| `alloydb.googleapis.com/database/postgresql/new_connections_for_top_databases`       | Total number of new connections added per database for top 500 databases to the instance.                                              | `alloydb.googleapis.com/Database` | `cluster_id`, `instance_id`, `database`                             |
| `alloydb.googleapis.com/database/postgresql/deadlock_count_for_top_databases`        | Total number of deadlocks detected in the instance per database for top 500 dbs.                                                       | `alloydb.googleapis.com/Database` | `cluster_id`, `instance_id`, `database`                             |
| `alloydb.googleapis.com/database/postgresql/statements_executed_count`               | Total count of statements executed in the instance per database per operation_type.                                                    | `alloydb.googleapis.com/Database` | `cluster_id`, `instance_id`, `database`, `operation_type`           |
| `alloydb.googleapis.com/instance/postgresql/returned_tuples_count`                   | Number of rows scanned while processing the queries in the instance since the last sample.                                             | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/fetched_tuples_count`                    | Number of rows fetched while processing the queries in the instance since the last sample.                                             | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/updated_tuples_count`                    | Number of rows updated while processing the queries in the instance since the last sample.                                             | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/inserted_tuples_count`                   | Number of rows inserted while processing the queries in the instance since the last sample.                                            | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/deleted_tuples_count`                    | Number of rows deleted while processing the queries in the instance since the last sample.                                             | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/written_tuples_count`                    | Number of rows written while processing the queries in the instance since the last sample.                                             | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/deadlock_count`                          | Number of deadlocks detected in the instance.                                                                                          | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/blks_read`                               | Number of blocks read by Postgres that were not in the buffer cache.                                                                   | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/blks_hit`                                | Number of times Postgres found the requested block in the buffer cache.                                                                | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/temp_bytes_written_count`                | The total amount of data(in bytes) written to temporary files by the queries while performing internal algorithms like join, sort etc.    | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/temp_files_written_count`                | The number of temporary files used for writing data in the instance while performing internal algorithms like join, sort etc.            | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/new_connections_count`                   | The number new connections added to the instance.                                                                                      | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |
| `alloydb.googleapis.com/instance/postgresql/wait_count`                              | Total number of times processes waited for each wait event in the instance.                                                            | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`, `wait_event_type`, `wait_event_name`   |
| `alloydb.googleapis.com/instance/postgresql/wait_time`                               | Total elapsed wait time for each wait event in the instance.                                                                           | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`, `wait_event_type`, `wait_event_name`   |
| `alloydb.googleapis.com/instance/postgres/transaction_count`                         | The number of committed and rolled back transactions across all serving nodes of the instance.                                         | `alloydb.googleapis.com/Instance` | `cluster_id`, `instance_id`                                         |

**Query Metrics**

| Metric Name                                                                      | Description                                                              | Monitored Resource             | Labels                                                                                              |
| -------------------------------------------------------------------------------- | ------------------------------------------------------------------------ | ------------------------------ | --------------------------------------------------------------------------------------------------- |
| `alloydb.googleapis.com/database/postgresql/insights/aggregate/latencies`        | Aggregated query latency distribution.                                   | `alloydb.googleapis.com/Database` | `user`, `client_addr`                                                                               |
| `alloydb.googleapis.com/database/postgresql/insights/aggregate/execution_time`   | Accumulated aggregated query execution time since the last sample.       | `alloydb.googleapis.com/Database` | `user`, `client_addr`                                                                               |
| `alloydb.googleapis.com/database/postgresql/insights/aggregate/io_time`          | Accumulated aggregated IO time since the last sample.                    | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `io_type`                                                                    |
| `alloydb.googleapis.com/database/postgresql/insights/aggregate/lock_time`        | Accumulated aggregated lock wait time since the last sample.             | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `lock_type`                                                                  |
| `alloydb.googleapis.com/database/postgresql/insights/aggregate/row_count`        | Aggregated number of retrieved or affected rows since the last sample.   | `alloydb.googleapis.com/Database` | `user`, `client_addr`                                                                               |
| `alloydb.googleapis.com/database/postgresql/insights/aggregate/shared_blk_access_count` | Aggregated shared blocks accessed by statement execution.              | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `access_type`                                                                |
| `alloydb.googleapis.com/database/postgresql/insights/perquery/latencies`         | Per query latency distribution.                                          | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `querystring`, `query_hash`                                                  |
| `alloydb.googleapis.com/database/postgresql/insights/perquery/execution_time`    | Accumulated execution times per user per database per query.             | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `querystring`, `query_hash`                                                  |
| `alloydb.googleapis.com/database/postgresql/insights/perquery/io_time`           | Accumulated IO time since the last sample per query.                     | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `io_type`, `querystring`, `query_hash`                                       |
| `alloydb.googleapis.com/database/postgresql/insights/perquery/lock_time`         | Accumulated lock wait time since the last sample per query.              | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `lock_type`, `querystring`, `query_hash`                                     |
| `alloydb.googleapis.com/database/postgresql/insights/perquery/row_count`         | The number of retrieved or affected rows since the last sample per query.| `alloydb.googleapis.com/Database` | `user`, `client_addr`, `querystring`, `query_hash`                                                  |
| `alloydb.googleapis.com/database/postgresql/insights/perquery/shared_blk_access_count` | Shared blocks accessed by statement execution per query.               | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `access_type`, `querystring`, `query_hash`                                   |
| `alloydb.googleapis.com/database/postgresql/insights/pertag/latencies`           | Query latency distribution.                                              | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash` |
| `alloydb.googleapis.com/database/postgresql/insights/pertag/execution_time`      | Accumulated execution times since the last sample.                       | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash` |
| `alloydb.googleapis.com/database/postgresql/insights/pertag/io_time`             | Accumulated IO time since the last sample per tag.                       | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `io_type`, `tag_hash` |
| `alloydb.googleapis.com/database/postgresql/insights/pertag/lock_time`           | Accumulated lock wait time since the last sample per tag.                | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `lock_type`, `tag_hash` |
| `alloydb.googleapis.com/database/postgresql/insights/pertag/shared_blk_access_count` | Shared blocks accessed by statement execution per tag.                 | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `access_type`, `tag_hash` |
| `alloydb.googleapis.com/database/postgresql/insights/pertag/row_count`           | The number of retrieved or affected rows since the last sample per tag.  | `alloydb.googleapis.com/Database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash` |

### Cloud SQL for PostgreSQL

**System Metrics**

| Metric Name                                                              | Description                                                                                                                            | Monitored Resource   | Labels                                                              |
| ------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------- | -------------------- | ------------------------------------------------------------------- |
| `cloudsql.googleapis.com/database/postgresql/new_connection_count`       | Count of new connections added to the postgres instance.                                                                               | `cloudsql_database`  | `database`, `project_id`, `database_id`                             |
| `cloudsql.googleapis.com/database/postgresql/backends_in_wait`           | Number of backends in wait in postgres instance.                                                                                       | `cloudsql_database`  | `backend_type`, `wait_event`, `wait_event_type`, `project_id`, `database_id` |
| `cloudsql.googleapis.com/database/postgresql/transaction_count`          | Delta count of number of transactions.                                                                                                 | `cloudsql_database`  | `database`, `transaction_type`, `project_id`, `database_id`         |
| `cloudsql.googleapis.com/database/memory/components`                     | Memory stats components in percentage as usage, cache and free memory for the database.                                                | `cloudsql_database`  | `component`, `project_id`, `database_id`                            |
| `cloudsql.googleapis.com/database/postgresql/external_sync/max_replica_byte_lag` | Replication lag in bytes for Postgres External Server (ES) replicas. Aggregated across all DBs on the replica.                       | `cloudsql_database`  | `project_id`, `database_id`                                         |
| `cloudsql.googleapis.com/database/cpu/utilization`                       | Current CPU utilization represented as a percentage of the reserved CPU that is currently in use.                                      | `cloudsql_database`  | `project_id`, `database_id`                                         |
| `cloudsql.googleapis.com/database/disk/bytes_used_by_data_type`          | Data utilization in bytes.                                                                                                             | `cloudsql_database`  | `data_type`, `project_id`, `database_id`                            |
| `cloudsql.googleapis.com/database/disk/read_ops_count`                   | Delta count of data disk read IO operations.                                                                                           | `cloudsql_database`  | `project_id`, `database_id`                                         |
| `cloudsql.googleapis.com/database/disk/write_ops_count`                  | Delta count of data disk write IO operations.                                                                                          | `cloudsql_database`  | `project_id`, `database_id`                                         |
| `cloudsql.googleapis.com/database/postgresql/num_backends_by_state`      | Number of connections to the Cloud SQL PostgreSQL instance, grouped by its state.                                                      | `cloudsql_database`  | `database`, `state`, `project_id`, `database_id`                    |
| `cloudsql.googleapis.com/database/postgresql/num_backends`               | Number of connections to the Cloud SQL PostgreSQL instance.                                                                            | `cloudsql_database`  | `database`, `project_id`, `database_id`                             |
| `cloudsql.googleapis.com/database/network/received_bytes_count`          | Delta count of bytes received through the network.                                                                                     | `cloudsql_database`  | `project_id`, `database_id`                                         |
| `cloudsql.googleapis.com/database/network/sent_bytes_count`              | Delta count of bytes sent through the network.                                                                                         | `cloudsql_database`  | `destination`, `project_id`, `database_id`                          |
| `cloudsql.googleapis.com/database/postgresql/deadlock_count`             | Number of deadlocks detected for this database.                                                                                        | `cloudsql_database`  | `database`, `project_id`, `database_id`                             |
| `cloudsql.googleapis.com/database/postgresql/blocks_read_count`          | Number of disk blocks read by this database. The source field distingushes actual reads from disk versus reads from buffer cache.        | `cloudsql_database`  | `database`, `source`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/postgresql/tuples_processed_count`     | Number of tuples(rows) processed for a given database for operations like insert, update or delete.                                    | `cloudsql_database`  | `operation_type`, `database`, `project_id`, `database_id`           |
| `cloudsql.googleapis.com/database/postgresql/tuple_size`                 | Number of tuples (rows) in the database.                                                                                               | `cloudsql_database`  | `database`, `tuple_state`, `project_id`, `database_id`              |
| `cloudsql.googleapis.com/database/postgresql/vacuum/oldest_transaction_age` | Age of the oldest transaction yet to be vacuumed in the Cloud SQL PostgreSQL instance.                                                 | `cloudsql_database`  | `oldest_transaction_type`, `project_id`, `database_id`              |
| `cloudsql.googleapis.com/database/replication/log_archive_success_count` | Number of successful attempts for archiving replication log files.                                                                     | `cloudsql_database`  | `project_id`, `database_id`                                         |
| `cloudsql.googleapis.com/database/replication/log_archive_failure_count` | Number of failed attempts for archiving replication log files.                                                                         | `cloudsql_database`  | `project_id`, `database_id`                                         |
| `cloudsql.googleapis.com/database/postgresql/transaction_id_utilization` | Current utilization represented as a percentage of transaction IDs consumed by the Cloud SQL PostgreSQL instance.                        | `cloudsql_database`  | `project_id`, `database_id`                                         |
| `cloudsql.googleapis.com/database/postgresql/num_backends_by_application`| Number of connections to the Cloud SQL PostgreSQL instance, grouped by applications.                                                   | `cloudsql_database`  | `application`, `project_id`, `database_id`                          |
| `cloudsql.googleapis.com/database/postgresql/tuples_fetched_count`       | Total number of rows fetched as a result of queries per database in the PostgreSQL instance.                                           | `cloudsql_database`  | `database`, `project_id`, `database_id`                             |
| `cloudsql.googleapis.com/database/postgresql/tuples_returned_count`      | Total number of rows scanned while processing the queries per database in the PostgreSQL instance.                                     | `cloudsql_database`  | `database`, `project_id`, `database_id`                             |
| `cloudsql.googleapis.com/database/postgresql/temp_bytes_written_count`   | Total amount of data (in bytes) written to temporary files by the queries per database.                                                | `cloudsql_database`  | `database`, `project_id`, `database_id`                             |
| `cloudsql.googleapis.com/database/postgresql/temp_files_written_count`   | Total number of temporary files used for writing data while performing algorithms such as join and sort.                                 | `cloudsql_database`  | `database`, `project_id`, `database_id`                             |

**Query Metrics**

| Metric Name                                                                      | Description                                                              | Monitored Resource           | Labels                                                                                              |
| -------------------------------------------------------------------------------- | ------------------------------------------------------------------------ | ---------------------------- | --------------------------------------------------------------------------------------------------- |
| `cloudsql.googleapis.com/database/postgresql/insights/aggregate/latencies`       | Aggregated query latency distribution.                                   | `cloudsql_instance_database` | `user`, `client_addr`, `project_id`, `resource_id`                                                  |
| `cloudsql.googleapis.com/database/postgresql/insights/aggregate/execution_time`  | Accumulated aggregated query execution time since the last sample.       | `cloudsql_instance_database` | `user`, `client_addr`, `project_id`, `resource_id`                                                  |
| `cloudsql.googleapis.com/database/postgresql/insights/aggregate/io_time`         | Accumulated aggregated IO time since the last sample.                    | `cloudsql_instance_database` | `user`, `client_addr`, `io_type`, `project_id`, `resource_id`                                        |
| `cloudsql.googleapis.com/database/postgresql/insights/aggregate/lock_time`       | Accumulated aggregated lock wait time since the last sample.             | `cloudsql_instance_database` | `user`, `client_addr`, `lock_type`, `project_id`, `resource_id`                                      |
| `cloudsql.googleapis.com/database/postgresql/insights/aggregate/row_count`       | Aggregated number of retrieved or affected rows since the last sample.   | `cloudsql_instance_database` | `user`, `client_addr`, `project_id`, `resource_id`                                                  |
| `cloudsql.googleapis.com/database/postgresql/insights/aggregate/shared_blk_access_count` | Aggregated shared blocks accessed by statement execution.              | `cloudsql_instance_database` | `user`, `client_addr`, `access_type`, `project_id`, `resource_id`                                   |
| `cloudsql.googleapis.com/database/postgresql/insights/perquery/latencies`        | Per query latency distribution.                                          | `cloudsql_instance_database` | `user`, `client_addr`, `querystring`, `query_hash`, `project_id`, `resource_id`                     |
| `cloudsql.googleapis.com/database/postgresql/insights/perquery/execution_time`   | Accumulated execution times per user per database per query.             | `cloudsql_instance_database` | `user`, `client_addr`, `querystring`, `query_hash`, `project_id`, `resource_id`                     |
| `cloudsql.googleapis.com/database/postgresql/insights/perquery/io_time`          | Accumulated IO time since the last sample per query.                     | `cloudsql_instance_database` | `user`, `client_addr`, `io_type`, `querystring`, `query_hash`, `project_id`, `resource_id`          |
| `cloudsql.googleapis.com/database/postgresql/insights/perquery/lock_time`        | Accumulated lock wait time since the last sample per query.              | `cloudsql_instance_database` | `user`, `client_addr`, `lock_type`, `querystring`, `query_hash`, `project_id`, `resource_id`       |
| `cloudsql.googleapis.com/database/postgresql/insights/perquery/row_count`        | The number of retrieved or affected rows since the last sample per query.| `cloudsql_instance_database` | `user`, `client_addr`, `querystring`, `query_hash`, `project_id`, `resource_id`                     |
| `cloudsql.googleapis.com/database/postgresql/insights/perquery/shared_blk_access_count` | Shared blocks accessed by statement execution per query.               | `cloudsql_instance_database` | `user`, `client_addr`, `access_type`, `querystring`, `query_hash`, `project_id`, `resource_id`     |
| `cloudsql.googleapis.com/database/postgresql/insights/pertag/latencies`          | Query latency distribution.                                              | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash`, `project_id`, `resource_id` |
| `cloudsql.googleapis.com/database/postgresql/insights/pertag/execution_time`     | Accumulated execution times since the last sample.                       | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash`, `project_id`, `resource_id` |
| `cloudsql.googleapis.com/database/postgresql/insights/pertag/io_time`            | Accumulated IO time since the last sample per tag.                       | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `io_type`, `tag_hash`, `project_id`, `resource_id` |
| `cloudsql.googleapis.com/database/postgresql/insights/pertag/lock_time`          | Accumulated lock wait time since the last sample per tag.                | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `lock_type`, `tag_hash`, `project_id`, `resource_id` |
| `cloudsql.googleapis.com/database/postgresql/insights/pertag/shared_blk_access_count` | Shared blocks accessed by statement execution per tag.                 | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `access_type`, `tag_hash`, `project_id`, `resource_id` |
| `cloudsql.googleapis.com/database/postgresql/insights/pertag/row_count`          | The number of retrieved or affected rows since the last sample per tag.  | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash`, `project_id`, `resource_id` |

### Cloud SQL for MySQL

**System Metrics**

| Metric Name                                                 | Description                                                              | Monitored Resource   | Labels                                                    |
| ----------------------------------------------------------- | ------------------------------------------------------------------------ | -------------------- | --------------------------------------------------------- |
| `cloudsql.googleapis.com/database/cpu/utilization`          | Current CPU utilization as a percentage of reserved CPU.                 | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/network/connections`      | Number of connections to the database instance.                          | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/network/received_bytes_count` | Delta count of bytes received through the network.                       | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/network/sent_bytes_count` | Delta count of bytes sent through the network.                           | `cloudsql_database`  | `destination`, `database`, `project_id`, `database_id`    |
| `cloudsql.googleapis.com/database/memory/components`        | Memory usage for components like usage, cache, and free memory.          | `cloudsql_database`  | `component`, `database`, `project_id`, `database_id`      |
| `cloudsql.googleapis.com/database/disk/bytes_used_by_data_type` | Data utilization in bytes.                                               | `cloudsql_database`  | `data_type`, `database`, `project_id`, `database_id`      |
| `cloudsql.googleapis.com/database/disk/read_ops_count`      | Delta count of data disk read IO operations.                             | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/disk/write_ops_count`     | Delta count of data disk write IO operations.                            | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/queries`            | Delta count of statements executed by the server.                        | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/questions`          | Delta count of statements sent by the client.                            | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/received_bytes_count` | Delta count of bytes received by MySQL process.                          | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/sent_bytes_count`   | Delta count of bytes sent by MySQL process.                              | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/innodb_buffer_pool_pages_dirty` | Number of unflushed pages in the InnoDB buffer pool.                     | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/innodb_buffer_pool_pages_free` | Number of unused pages in the InnoDB buffer pool.                        | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/innodb_buffer_pool_pages_total` | Total number of pages in the InnoDB buffer pool.                         | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/innodb_data_fsyncs` | Delta count of InnoDB fsync() calls.                                     | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/innodb_os_log_fsyncs` | Delta count of InnoDB fsync() calls to the log file.                     | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/innodb_pages_read`  | Delta count of InnoDB pages read.                                        | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/innodb_pages_written` | Delta count of InnoDB pages written.                                     | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/open_tables`        | The number of tables that are currently open.                            | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/opened_table_count` | The number of tables opened since the last sample.                       | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/open_table_definitions` | The number of table definitions currently cached.                        | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/opened_table_definitions_count` | The number of table definitions cached since the last sample.            | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/mysql/innodb/dictionary_memory` | Memory allocated for the InnoDB dictionary cache.                        | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |

**Query Metrics**

| Metric Name                                                 | Description                                                              | Monitored Resource           | Labels                                                                                                                            |
| ----------------------------------------------------------- | ------------------------------------------------------------------------ | ---------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| `dbinsights.googleapis.com/aggregate/latencies`             | Cumulative query latency distribution per user and database.             | `cloudsql_instance_database` | `user`, `client_addr`, `database`, `project_id`, `resource_id`                                                                    |
| `dbinsights.googleapis.com/aggregate/execution_time`        | Cumulative query execution time per user and database.                   | `cloudsql_instance_database` | `user`, `client_addr`, `database`, `project_id`, `resource_id`                                                                    |
| `dbinsights.googleapis.com/aggregate/execution_count`       | Total number of query executions per user and database.                  | `cloudsql_instance_database` | `user`, `client_addr`, `database`, `project_id`, `resource_id`                                                                    |
| `dbinsights.googleapis.com/aggregate/lock_time`             | Cumulative lock wait time per user and database.                         | `cloudsql_instance_database` | `user`, `client_addr`, `lock_type`, `database`, `project_id`, `resource_id`                                                      |
| `dbinsights.googleapis.com/aggregate/io_time`               | Cumulative IO wait time per user and database.                           | `cloudsql_instance_database` | `user`, `client_addr`, `database`, `project_id`, `resource_id`                                                                    |
| `dbinsights.googleapis.com/aggregate/row_count`             | Total number of rows affected during query execution.                    | `cloudsql_instance_database` | `user`, `client_addr`, `row_status`, `database`, `project_id`, `resource_id`                                                     |
| `dbinsights.googleapis.com/perquery/latencies`              | Cumulative query latency distribution per user, database, and query.     | `cloudsql_instance_database` | `querystring`, `user`, `client_addr`, `query_hash`, `database`, `project_id`, `resource_id`                                      |
| `dbinsights.googleapis.com/perquery/execution_time`         | Cumulative query execution time per user, database, and query.           | `cloudsql_instance_database` | `querystring`, `user`, `client_addr`, `query_hash`, `database`, `project_id`, `resource_id`                                      |
| `dbinsights.googleapis.com/perquery/execution_count`        | Total number of query executions per user, database, and query.          | `cloudsql_instance_database` | `querystring`, `user`, `client_addr`, `query_hash`, `database`, `project_id`, `resource_id`                                      |
| `dbinsights.googleapis.com/perquery/lock_time`              | Cumulative lock wait time per user, database, and query.                 | `cloudsql_instance_database` | `querystring`, `user`, `client_addr`, `lock_type`, `query_hash`, `database`, `project_id`, `resource_id`                          |
| `dbinsights.googleapis.com/perquery/io_time`                | Cumulative io wait time per user, database, and query.                   | `cloudsql_instance_database` | `querystring`, `user`, `client_addr`, `query_hash`, `database`, `project_id`, `resource_id`                                      |
| `dbinsights.googleapis.com/perquery/row_count`              | Total number of rows affected during query execution.                    | `cloudsql_instance_database` | `querystring`, `user`, `client_addr`, `query_hash`, `row_status`, `database`, `project_id`, `resource_id`                         |
| `dbinsights.googleapis.com/pertag/latencies`                | Cumulative query latency distribution per user, database, and tag.       | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash`, `database`, `project_id`, `resource_id` |
| `dbinsights.googleapis.com/pertag/execution_time`           | Cumulative query execution time per user, database, and tag.             | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash`, `database`, `project_id`, `resource_id` |
| `dbinsights.googleapis.com/pertag/execution_count`          | Total number of query executions per user, database, and tag.            | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash`, `database`, `project_id`, `resource_id` |
| `dbinsights.googleapis.com/pertag/lock_time`                | Cumulative lock wait time per user, database and tag.                    | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `lock_type`, `tag_hash`, `database`, `project_id`, `resource_id` |
| `dbinsights.googleapis.com/pertag/io_time`                  | Cumulative IO wait time per user, database and tag.                      | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash`, `database`, `project_id`, `resource_id` |
| `dbinsights.googleapis.com/pertag/row_count`                | Total number of rows affected during query execution.                    | `cloudsql_instance_database` | `user`, `client_addr`, `action`, `application`, `controller`, `db_driver`, `framework`, `route`, `tag_hash`, `row_status`, `database`, `project_id`, `resource_id` |

### Cloud SQL for SQL Server

**System Metrics**

| Metric Name                                                              | Description                                                              | Monitored Resource   | Labels                                                    |
| ------------------------------------------------------------------------ | ------------------------------------------------------------------------ | -------------------- | --------------------------------------------------------- |
| `cloudsql.googleapis.com/database/cpu/utilization`                       | Current CPU utilization as a percentage of the reserved CPU.             | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/memory/usage`                          | RAM usage in bytes, excluding buffer/cache.                              | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/memory/total_usage`                    | Total RAM usage in bytes, including buffer/cache.                        | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/disk/bytes_used`                       | Data utilization in bytes.                                               | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/disk/quota`                            | Maximum data disk size in bytes.                                         | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/disk/read_ops_count`                   | Delta count of data disk read IO operations.                             | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/disk/write_ops_count`                  | Delta count of data disk write IO operations.                            | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/network/received_bytes_count`          | Delta count of bytes received through the network.                       | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/network/sent_bytes_count`              | Delta count of bytes sent through the network.                           | `cloudsql_database`  | `destination`, `database`, `project_id`, `database_id`    |
| `cloudsql.googleapis.com/database/sqlserver/memory/buffer_cache_hit_ratio` | Current percentage of pages found in the buffer cache without reading from disk. | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/memory/memory_grants_pending` | Current number of processes waiting for a workspace memory grant.        | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/memory/free_list_stall_count` | Total number of requests that waited for a free page.                    | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/swap/pages_swapped_in_count`           | Total count of pages swapped in from disk since the system was booted.   | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/swap/pages_swapped_out_count`          | Total count of pages swapped out to disk since the system was booted.    | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/memory/checkpoint_page_count` | Total number of pages flushed to disk by a checkpoint.                   | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/memory/lazy_write_count`     | Total number of buffers written by the buffer manager's lazy writer.     | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/memory/page_life_expectancy` | Current number of seconds a page will stay in the buffer pool.           | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/memory/page_operation_count` | Total number of physical database page reads or writes.                  | `cloudsql_database`  | `operation`, `database`, `project_id`, `database_id`      |
| `cloudsql.googleapis.com/database/sqlserver/transactions/page_split_count` | Total number of page splits from overflowing index pages.                | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/transactions/deadlock_count` | Total number of lock requests that resulted in a deadlock.               | `cloudsql_database`  | `locked_resource`, `database`, `project_id`, `database_id`|
| `cloudsql.googleapis.com/database/sqlserver/transactions/transaction_count` | Total number of transactions started.                                    | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/transactions/batch_request_count` | Total number of Transact-SQL command batches received.                   | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/transactions/sql_compilation_count` | Total number of SQL compilations.                                        | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/transactions/sql_recompilation_count` | Total number of SQL recompilations.                                      | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/connections/processes_blocked` | Current number of blocked processes.                                     | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/transactions/lock_wait_time` | Total time lock requests were waiting for locks.                         | `cloudsql_database`  | `locked_resource`, `database`, `project_id`, `database_id`|
| `cloudsql.googleapis.com/database/sqlserver/transactions/lock_wait_count` | Total number of lock requests that required the caller to wait.          | `cloudsql_database`  | `locked_resource`, `database`, `project_id`, `database_id`|
| `cloudsql.googleapis.com/database/network/connections`                   | Number of connections to databases on the instance.                      | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/connections/login_attempt_count` | Total number of login attempts since the last server restart.            | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/connections/logout_count`    | Total number of logout operations since the last server restart.         | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/connections/connection_reset_count` | Total number of logins started from the connection pool since the last server restart. | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
| `cloudsql.googleapis.com/database/sqlserver/transactions/full_scan_count` | Total number of unrestricted full scans (base-table or full-index).      | `cloudsql_database`  | `database`, `project_id`, `database_id`                   |
