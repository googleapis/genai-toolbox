sources:
    my-cloud-sql-pg-source:
        kind: cloud-sql-postgres
        project: twisha-dev
        region: us-central1
        instance: test-instance
        database: sdk_test
        user: postgres
        password: cloudsql

authSources:
    my-test-auth:
        kind: google
        client_id: client1
tools:
  # search-airports:
  #   kind: postgres-sql
  #   source: my-cloud-sql-pg-source
  #   description: |
  #     Use this tool to list all airports matching search criteria.
  #     Takes country and returns all matching airports.
  #     The agent can decide to return the results directly to the user.
  #     Input of this tool must be in JSON format and include a country.
  #     Example:
  #     {{
  #         "country": "United States",
  #     }}
  #     Example:
  #     {{
  #         "country": "Mexico",
  #     }}
  #   parameters:
  #     - name: country
  #       type: string
  #       description: Country
  #   statement: |
  #     SELECT * FROM airports
  #     WHERE (CAST($1 AS TEXT) IS NULL OR country ILIKE $1)
  # get-n-rows:
  #   kind: postgres-sql
  #   source: my-cloud-sql-pg-source
  #   description: |
  #     This tool is used to get the first n rows in a table.
  #     Example
  #       {{
  #           "num_rows": "3"
  #       }}
  #   parameters:
  #     - name: num_rows
  #       type: string
  #       description: Number of rows to get
  #   statement: SELECT * FROM test_table LIMIT $1;
  get-row-by-id-auth:
    kind: postgres-sql
    source: my-cloud-sql-pg-source
    description: |
      This tool is used to get a row by it's id.
      Example
        {{
            "table_name": "test_table"
            "id": "2"
        }}
    parameters:
      # - name: table_name
      #   type: string
      #   description: Random table name
      - name: id
        type: string
        description: Given by user
        authSources:
          - name: my-test-auth
            field: sub
    statement: SELECT * FROM test_table WHERE id = $1;
  # get-row-by-id:
  #   kind: postgres-sql
  #   source: my-cloud-sql-pg-source
  #   description: |
  #     This tool is used to get a row by it's id.
  #     Example
  #       {{
  #           "id": "2"
  #       }}
  #   parameters:
  #     - name: id
  #       type: string
  #       description: id
  #   statement: SELECT * FROM test_table WHERE id = $1;
  # search-airports-test:
  #   kind: cloud-sql-postgres-generic
  #   source: my-cloud-sql-pg-source
  #   description: |
  #     Use this tool to list all airports matching search criteria.
  #     Takes at least one of country, city, name, or all and returns all matching airports.
  #     The agent can decide to return the results directly to the user.
  #     Input of this tool must be in JSON format and include all three inputs - country, city, name.
  #     Example:
  #     {{
  #         "country": "United States",
  #         "city": "San Francisco",
  #         "name": null
  #     }}
  #     Example:
  #     {{
  #         "country": null,
  #         "city": "Goroka",
  #         "name": "Goroka"
  #     }}
  #     Example:
  #     {{
  #         "country": "Mexico",
  #         "city": null,
  #         "name": null
  #     }}
  #   parameters:
  #     - name: country
  #       type: string
  #       description: Country
  #     - name: city
  #       type: string
  #       description: City
  #     - name: name
  #       type: string
  #       description: Airport name
  #   statement: |
  #     SELECT * FROM airports
  #     WHERE (CAST($1 AS TEXT) IS NULL OR country ILIKE $1)
  #     AND (CAST($2 AS TEXT) IS NULL OR city ILIKE $2)
  #     AND (CAST($3 AS TEXT) IS NULL OR name ILIKE '%' || $3 || '%')
  #     LIMIT 10
# toolsets:
#     my-toolset:
#       - get-row-by-id
#     my-toolset-2:
#       - get-row-by-id
#       - get-n-rows